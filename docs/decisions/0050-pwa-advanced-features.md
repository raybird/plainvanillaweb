# ADR 0050: 原生 PWA 安裝引導與進階同步機制

## 上下文
雖然專案已具備 Service Worker 快取，但缺乏主動引導使用者「安裝至桌面」的能力，且對於離線狀態下的數據同步仍依賴於頁面開啟時的邏輯。為了提供更接近原生應用的體驗，我們需要整合進階的 PWA 特性。

## 決策
1.  **實作 PWAService**: 管理 `beforeinstallprompt` 事件，提供自定義的安裝按鈕接口，而非僅依賴瀏覽器預設提示。
2.  **整合 Background Sync API**: 允許應用在網路恢復時自動執行待處理的數據同步任務，即使頁面已關閉。
3.  **整合 Periodic Background Sync**: 支援定期的背景更新（如每小時更新一次 API 快取），確保使用者在離線打開應用時看到的數據是最新的。
4.  **UI 整合**: 在實驗室 (Lab) 中提供「安裝應用」與「背景同步測試」範例。

## 後果
- **優點**: 大幅提升應用程式的留存率（透過安裝）與數據完整性（透過背景同步）。
- **優點**: 展示了 PWA 如何在不消耗顯著電力的情況下維持數據活性。
- **缺點**: Periodic Background Sync 對網站「參與度 (Site Engagement)」有嚴格要求，在非頻繁使用的情況下可能不會觸發。
- **缺點**: Background Sync 主要在 Chrome/Edge 中支援度較好，Safari 仍有限制。
