# ADR 0056: 引入 Shadow DOM 支援與元件隔離策略

## 狀態
已提議 (Proposed)

## 背景
`plainvanillaweb` 目前的組件系統基於 Custom Elements，但所有組件都渲染在 Light DOM 中。這雖然方便開發者調試與全域樣式管理，但在以下情境存在侷限性：
1. **樣式衝突**：大型專案中，全域 CSS 容易影響組件內部樣式。
2. **SDK 模式**：當作為 SDK 提供給第三方網站時，無法保證宿主環境不破壞組件 UI。
3. **封裝性**：無法真正隱藏組件內部的實作細節（如內建的按鈕或容器）。

## 決策
我們決定在 `BaseComponent` 中引入可選的 Shadow DOM 支援。
1. **模式選擇**：預設為 `open` 模式，允許外部透過 `shadowRoot` 進行必要的存取。
2. **樣式處理**：組件內部的 CSS 將透過 `<style>` 標籤注入 Shadow Root，或使用 `CSSStyleSheet` (如果瀏覽器支援)。
3. **向後相容**：現有的 Light DOM 組件將不受影響，開發者可透過靜態屬性 `useShadow = true` 開啟隔離模式。

## 後果
- **優點**：強大的樣式隔離、更好的封裝性、更適合 SDK 模式。
- **缺點**：外部樣式（如全域字體或主題變數）需要透過 CSS Variables 或 `::part` 進行傳遞，增加了樣式設計的複雜度。
